<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fetch + async/await (versión básica)</title>
  <style>
    .t5x5 {
      border-collapse: collapse;
      margin-top: 8px;
    }

    .t5x5 td {
      border: 1px solid #444;
      width: 60px;
      height: 60px;
      text-align: center;
    }

    #estado {
      font: 12px/1.2 system-ui, sans-serif;
      color: #333;
      margin-left: 8px;
    }

    img{
      width: 100px;
      height: 100px;
    }
    pre {
      background: #f4f4f4;
      padding: 8px;
      max-width: 520px;
      overflow: auto;
    }
  </style>
</head>

<body>
  <button id="btn-cargar">Leer palabra del endpoint</button>
  <span id="estado"></span>

  <table class="t5x5">
    <tr id="fila-1">
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </table>

  <script>
    'use strict';

    const ENDPOINT = "http://185.60.43.155:3000/api/word/1";

    // 1) Función asíncrona: usa await con fetch y con resp.json() (Sin control de errores)

    async function leerPalabra() {
      const resp = await fetch(ENDPOINT);      // espera la respuesta HTTP
      const data = await resp.json();          // lee y parsea el cuerpo a JSON
      const palabra = (data.word).toUpperCase();
      ponerEnPrimeraFilaComoTexto(palabra);
    }

    //Pasar palabra a número para coger las letras
    function pasarPalabraANumero(palabra){
      const mapaLetras = {
                  Q: "00", W: "01", E: "02", R: "03", T: "04", Y: "05",
                  U: "06", I: "07", O: "08", P: "09",
                  A: "10", S: "11", D: "12", F: "13", G: "14", H: "15", J: "16", K: "17", L: "18", Ñ: "19",
                  Z: "21", X: "22", C: "23", V: "24", B: "25", N: "26", M: "27"
                };
      
      const pal=[];
      for (let letra of palabra){
        const codigo = mapaLetras[letra] || "??";
        pal.push(codigo);
      }
      return pal;
    }
    function ponerEnPrimeraFilaComoTexto(palabra) {
      const numeros = pasarPalabraANumero(palabra);
      const celdas = document.querySelectorAll("#fila-1 td");

      celdas.forEach((td, i) => {
        td.innerHTML = "";                // limpia la celda
        const codigo = numeros[i];        // letra i-ésima (o undefined)
        if (codigo){
          const im = new Image();
          im.src = `lingo-reto-1/verdes/${codigo}.png`;
          im.alt = palabra[i];
          td.appendChild(im);
        }
      });
    }
    // 3) Botón
    document.getElementById("btn-cargar").addEventListener("click", leerPalabra);
  </script>
</body>
</html>